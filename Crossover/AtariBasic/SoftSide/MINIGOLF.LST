;
; Mini Golf
; Original Program by Mitch Voth
; Atari Translation by Rich Bouchard
;
; Softside Vol 3-05 Feb 1981
;

10 GR.0:POK.752,1:?:CL.#1:O.#1,4,0,"K:"
15 DIM Z$(100),A$(30),S(10):?,"":?,""
20 Z$(1)=" ":Z$(100)=" ":Z$(2)=Z$(1)
25 F.A=1TO10:S(A)=0:N.A
30 POK.752,1:POS.2,5:?"NUMBER OF PLAYERS ?";:GET#1,NP:POK.752,0:NP=NP-48:IFNP<1ORNP>9THEN30
32 ?CHR$(NP+48):F.A=1TONP:S(NP)=0:?"PLAYER #";A;"'S NAME ";:I.A$:IFLEN(A$)>10THENA$=A$(1,10)
33 IFLEN(A$)=0THENA$=" "
34 Z$(A*10-LEN(A$)+1,A*10)=A$:N.A:GR.5:POK.752,1
38 POK.708,0:POK.712,58:G.300

40 GR.0:POK.752,1:?"        ":?:F.A=1TONP:?Z$(A*10-9,A*10),S(A):N.A
42 ?:?"HIT ANY KEY":GET#1,A:GR.5:POK.752,1:POK.708,0:POK.712,58:RET.

50 GET#1,Z:IFZ<58ANDZ>48THENHH=(Z-48)*11:HM=0:VM=0:COL.A:PL.C1,C2:G.200
60 T=0:IFZ<>43ANDZ<>44ANDZ<>45ANDZ<>91ANDZ<>31THEN70
62 CP=CP+1:IFCP=17THENCP=1
64 COL.A:PL.C1,C2:G.100
70 IFZ<>42ANDZ<>61ANDZ<>46ANDZ<>93ANDZ<>30THEN50
72 CP=CP-1:IFCP=0THENCP=16
74 COL.A:PL.C1,C2:G.100

90 COL.1:PL.HP1,HP2:PL.HP1+1,HP2
92 COL.3:PL.B1,B2:LOC.C1,C2,A:IFA<>2THENCOL.2:PL.C1,C2:G.50
94 COL.3:PL.C1,C2:G.50

;
; Get club position and vector
;

100 G.CP+100
101 C1=B1:C2=B2+2:M1=0:M2=-1:G.90
102 C1=B1+1:M1=-1:G.90
103 C1=B1+2:C2=B2+2:M1=-2:G.90
104 C2=B2+1:M2=-0.5:G.90
105 C2=B2:M2=0:G.90
106 C2=B2-1:M2=0.5:G.90
107 C1=B1+2:C2=B2-2:M1=-2:M2=1:G.90
108 C1=B1+1:M1=-1:G.90
109 C1=B1:M1=0:G.90
110 C1=B1-1:M1=1:G.90
111 C1=B1-2:C2=B2-2:M1=2:M2=1:G.90
112 C2=B2-1:M2=0.5:G.90
113 C2=B2:M2=0:G.90
114 C2=B2+1:M2=-0.5:G.90
115 C1=B1-2:C2=B2+2:M1=2:M2=-1:G.90
116 C1=B1-1:M1=1:G.90

;
; Sunk the ball
;

150 COL.3:PL.HP1,HP2:PL.HP1+1,HP2:IFS>1THEN156
152 ?"A HOLE IN ONE!!!!!!":F.A=1TO5:F.B=1TO59:SE.4,B/4+1,14:SO.0,B,0,10:N.B:N.A
154 POK.712,58:SO.0,0,0,0:G.158
156 ?"THAT TOOK YOU ";S;" STROKES":F.A=1TO50:SO.0,A,10,10:N.A:F.A=49TO2 STEP -1
157 SO.0,A,10,10:N.A:SO.0,0,0,0
158 F.A=1TO700:N.A:?CHR$(28);"                                  ":?CHR$(28);CHR$(28);:RET.
200 D1=B1:D2=B2:COL.2:PL.B1,B2:IF(ABS(M1)=1ANDHM=1)ORABS(M1)=2THEN204
202 HM=1:G.210
204 D1=B1+SGN(M1):HM=0
205 T=T+1:IFT>4THENRC=2:RET.
210 SO.0,200,10,10:SO.0,0,0,0:LOC.D1,B2,A:IFA=0THENRC=0:RET.
211 IF(D1<>HP1 ANDD1<>HP1+1)ORD2<>HP2 THENIFA=1THENRC=0:RET.
212 COL.3:PL.D1,B2:B1=D1:LOC.HP1,HP2,A:IFA<>1THENS(PT)=S(PT)+S-P:RC=1:GOS.150:RET.
214 LOC.HP1+1,HP2,A:IFA<>1THENS(PT)=S(PT)+S-P:RC=1:GOS.150:RET.
220 COL.2:PL.B1,B2:IF(ABS(M2)=0.5ANDVM=1)ORABS(M2)=1THEND2=B2+SGN(M2):VM=0:G.230
222 VM=1
230 LOC.B1,D2,A:IFA=0THENRC=0:RET.
231 IF(D1<>HP1 ANDD1<>HP1+1)ORD2<>HP2 THENIFA=1THENRC=0:RET.
232 COL.3:PL.B1,D2:B2=D2:LOC.HP1,HP2,A:IFA=3THENS(PT)=S(PT)+S-P:RC=1:GOS.150:RET.
234 LOC.HP1+1,HP2,A:IFA=3THENS(PT)=S(PT)+S-P:RC=1:GOS.150:RET.
240 T=0:HH=HH-1:IFHH<0THENRC=2:RET.
242 G.200

;
; Hole #1 - Par 2
;

300 COL.2:F.A=3TO36:PL.27,A:DR.45,A:N.A:?"  "
302 P=2:F.PT=1TONP:S=1:?Z$(PT*10-9,PT*10);"'S TURN":B1=INT(RND(0)*11+32):B2=31:CP=1
304 HP1=35:HP2=6
305 GOS.100
310 IFRC=2THENS=S+1:CP=1:GOS.100:G.310
320 IFRC=1THENN.PT:G.400
325 GOS.3000
330 IFD1=26ORD1=46THENM1=-M1:GOS.200:G.310
332 M2=-M2:GOS.200:G.310

;
; Hole #2 - Par 2
;

400 GOS.40:COL.2:F.A=13TO36:PL.27,A:DR.45,A:N.A:F.A=0TO11:PL.27+A,13-A:DR.70,13-A
402 N.A:?"  ":F.PT=1TONP:S=1:?Z$(PT*10-9,PT*10);"'S TURN"
404 HP1=60:HP2=8:B1=INT(RND(0)*11+32):B2=31
405 CP=1:GOS.100
420 IFRC=2THENS=S+1:CP=1:GOS.100:G.420
430 IFRC=1THENN.PT:G.500
435 GOS.3000
440 IFD2=1ORD2=37OR(D2=14ANDD1>45)THENM2=-M2:GOS.200:G.420
442 IFD1<27ORD1=46ORD1=71THENM1=-M1:GOS.200:G.420
444 A=M1:M1=-M2*2:M2=-A/2:GOS.200:G.420

;
; Hole #3 - Par 2
;

500 GOS.40:COL.2:F.A=13TO36:PL.17,A:DR.55,A:N.A:F.A=0TO11:PL.17+A,13-A:DR.55-A,13-A
502 N.A:COL.1:PL.36,10:DR.36,36
510 ?"  ":F.PT=1TONP:PRINT Z$(PT*10-9,PT*10);"'S TURN":B1=INT(RND(0)*11+42)
512 S=1:B2=32:CP=1:HP1=25:HP2=32:GOS.100
520 IFRC=2THENS=S+1:CP=1:GOS.100:G.520
530 IFRC=1THENN.PT:G.600
540 GOS.3000
550 IFD2=1ORD2=37THENM2=-M2:GOS.200:G.520
552 IFD1=16ORD1=36ORD1=56THENM1=-M1:GOS.200:G.520
554 IFD1<36THENA=M1:M1=-M2*2:M2=-A/2:GOS.200:G.520
556 A=M1:M1=M2*2:M2=A/2:GOS.200:G.520

;
; Hole #4 - Par 3
;

600 GOS.40:COL.2:F.A=13TO24:PL.21,A:DR.63,A:N.A:F.A=25TO36:PL.21,A:DR.35,A:N.A
602 F.A=1TO8:PL.36+A,24+A:DR.63-A,24+A:PL.21+A,13-A:DR.63-A,13-A:N.A
604 COL.1:PL.36,25:DR.36,14:DR.51,14:PL.51,14:DR.51,24
610 P=3:?"  ":F.PT=1TONP:PRINT Z$(PT*10-9,PT*10);"'S TURN":B1=INT(RND(0)*9)+24
615 S=1:B2=32:CP=1:HP1=43:HP2=19:GOS.100
620 IFRC=2THENS=S+1:CP=1:GOS.100:G.620
630 IFRC=1THENN.PT:G.700
640 GOS.3000
650 IFD2=4ORD2=12ORD2=37OR(D2=33ANDD1>44ANDD1<55)OR(D2=14ANDD1>36)THEN654
652 G.656
654 M2=-M2:GOS.200:G.620
656 IFD1=20ORD1=49ORD1=51ORD1=64ORD1=36THENM1=-M1:GOS.200:G.620
658 IF(D1>56ANDD2<13)OR(D2>24ANDD1<57)THENA=M1:M1=M2*2:M2=A/2:GOS.200:G.620
659 A=M1:M1=-M2*2:M2=-A/2
660 GOS.200:G.620

;
; Hole #5 - Par 2
;

700 GOS.40:COL.2:F.A=25TO36:PL.41,A:DR.55,A:N.A:F.A=1TO9:PL.33-A,25-A:DR.55,25-A
702 PL.24+A,11-A:DR.55-A,11-A:N.A:F.A=1TO5:PL.24,16-A:DR.55,16-A:N.A
704 COL.1:F.A=1TO2:PL.55,25-A:DR.45,15-A:N.A
710 ?"  ":P=2:F.PT=1TONP:S=1:?Z$(PT*10-9,PT*10);"'S TURN":CP=1
715 B1=INT(RND(0)*8)+43:B2=33:HP1=33:HP2=13:GOS.100
720 IFRC=2THENS=S+1:CP=1:GOS.100:G.720
730 IFRC=1THENN.PT:G.800
740 GOS.3000
750 IFD2=1ORD2=37OR(D2=25ANDD1<41)THENM2=-M2:GOS.200:G.720
752 IFD1=23ORD1=40ORD1=56THENM1=-M1:GOS.200:G.720
754 IFD1<40ANDD2<11THENA=M1:M1=-M2*2:M2=-A/2:GOS.200:G.720
756 A=M1:M1=M2*2:M2=A/2:GOS.200:G.720

;
; Hole #6 - Par 3
;

800 GOS.40:COL.2:F.A=25TO36:PL.31,A:DR.45,A:N.A:F.A=1TO11:PL.31,25-A:DR.51+A,25-A
801 N.A
802 F.A=2TO13:PL.31,A:DR.62,A:N.A:COL.1:F.A=1TO2:PL.30+A,24:DR.39+A,15:N.A
804 PL.41,15:DR.41,10:PL.49,10:DR.49,4
810 ?"  ":P=3:F.PT=1TONP:S=1:?Z$(PT*10-9,PT*10);"'S TURN"
815 B1=INT(RND(0)*8)+34:B2=33:HP1=35:HP2=13:CP=1:GOS.100
820 IFRC=2THENS=S+1:CP=1:GOS.100:G.820
830 IFRC=1THENN.PT:G.900
840 GOS.3000
850 IFD2=5ORD2=1ORD2=37OR(D2=25ANDD1>45)OR((D2=10)AND(D1=41ORD1=49))THENM2=-M2:GOS.200:G.820
852 IFD1=30ORD1=46ORD1=63ORD1=49OR(D1=41ANDD2<=16)THENM1=-M1:GOS.200:G.820
854 A=M1:M1=-M2*2:M2=-A/2:GOS.200:G.820

;
; Hole #7 - Par 3
;

900 GOS.40:COL.2:F.A=1TO9:PL.25-A,37-A:DR.54,37-A:PL.15+A,17-A:DR.51-A,17-A:N.A
902 F.A=21TO27:PL.16,A:DR.54,A:N.A:F.A=1TO4:PL.16,16+A:DR.50+A,16+A:N.A
904 COL.1:PL.38,11:DR.50,23:PL.38,16:DR.45,23:PL.26,27:DR.38,27
906 PL.39,27:DR.39,36
910 ?"  ":P=3:F.PT=1TONP:S=1:?Z$(PT*10-9,PT*10);"'S TURN"
915 B1=INT(RND(0)*8)+44:B2=33:HP1=33:HP2=32:CP=1:GOS.100
920 IFRC=2THENS=S+1:CP=1:GOS.100:G.920
930 IFRC=1THENN.PT:G.1000
940 GOS.3000
950 IFD1=15ORD1=55OR(D1=39ANDD2>26)THENM1=-M1:GOS.200:G.920
952 IFD2=37ORD2=7ORD2=27THENM2=-M2:GOS.200:G.920
954 IFD1<25ANDD2<17THENA=M1:M1=-M2*2:M2=-A/2:GOS.200:G.920
956 A=M1:M1=M2*2:M2=A/2:GOS.200:G.920

;
; Hole #8 - Par 3
;

1000 GOS.40:COL.2:F.A=27TO36:PL.29,A:DR.43,A:N.A:F.A=1TO8:PL.29-A,27-A:DR.43+A,27-A
1002 PL.21,19-A:DR.52,19-A:PL.21+A,11-A:DR.52-A,11-A:N.A
1004 COL.1:PL.30,11:DR.33,14:DR.33,21:DR.36,24:PL.37,24:DR.40,21:DR.40,14:DR.43,11
1010 ?"  ":P=3:F.PT=1TONP:S=1:?Z$(PT*10-9,PT*10)
1015 B1=INT(RND(0)*8+32):B2=33:HP1=36:HP2=17:CP=1:GOS.100
1020 IFRC=2THENS=S+1:CP=1:GOS.100:G.1020
1030 IFRC=1THENN.PT:G.1100
1040 GOS.3000
1050 IFD2=37ORD2=2THENM2=-M2:GOS.200:G.1020
1051 IFD1=33ORD1=40THENIFD2=21ORD2=14THEN1054
1052 IFD1=20ORD1=53ORD1=33ORD1=40ORD1=28ORD1=44THENM1=-M1:GOS.200:G.1020
1054 IF(D1>43ANDD2>18)OR(D1<30ANDD2<11)OR(D1>36ANDD1<44)THENA=M1:M1=-M2*2:M2=-A/2:GOS.200:G.1020
1056 A=M1:M1=M2*2:M2=A/2:GOS.200
1060 G.1020

;
; Hole #9 - Par 4
;

1100 GOS.40:COL.2:F.A=27TO36:PL.29,A:DR.43,A:N.A:F.A=3TO27:PL.20,A:DR.52,A:N.A
1102 COL.1:PL.34,10:DR.31,13:PL.39,10:DR.42,13:PL.27,14:DR.35,22:PL.38,22:DR.46,14
1110 ?"  ":P=4:F.PT=1TONP:S=1:?Z$(PT*10-9,PT*10);"'S TURN"
1115 B1=INT(RND(0)*8+32):B2=33:HP1=36:HP2=17:CP=1:GOS.100
1120 IFRC=2THENS=S+1:CP=1:GOS.100:G.1120
1130 IFRC=1THENN.PT:G.2000
1140 GOS.3000
1150 IFD2=37ORD2=2ORD2=28THENM2=-M2:GOS.200:G.1120
1152 IFD1=19ORD1=53OR((D1=28ORD1=44)ANDD2>26)THENM1=-M1:GOS.200:G.1120
1154 IF(D1>37ANDD2>13)OR(D1<36ANDD2<14)THENA=M1:M1=-M2*2:M2=-A/2:GOS.200:G.1120
1156 A=M1:M1=M2*2:M2=A/2:GOS.200
1160 G.1120

;
; Final Score
;

2000 GR.0:?"    ":?:?"    PLAYER  SCORE":?"-----------------"
2005 F.A=1TONP:?Z$(A*10-9,A*10);" : ";S(A):N.A:POK.752,1
2010 ?:?"PLAY AGAIN (Y/N)"
2020 GOS.3000:A=PEEK(764):IFA<>43ANDA<>35THEN2020
2030 IFA=43THENRUN
2040 POK.752,0:?:?:?"":CLOSE #1:POK.764,255:END

;
; Play sounds
;

3000 SO.0,50,10,10
3005 HH=HH-10:IFHH<2ANDHH>-6THENHH=2
3010 SO.0,200,10,10
3020 SO.0,0,0,0:RET.

9999 END

32766 POK.752,1:?CHR$(125);"LISTING 'D1:A'":LIST "D1:A":?"LISTING 'D2:A'":LIST "D2:A"
32767 POK.752,1:?"SAVING 'D1:MINIGOLF'":SAVE "D1:MINIGOLF":?:?"SAVING 'D2:MINIGOLF'":SAVE "D2:MINIGOLF"
