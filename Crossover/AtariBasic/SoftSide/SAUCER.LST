; SS SS SS SS SS SS SS SS SS SS SS
; SS                            SS
; SS        ATARI BASIC         SS
; SS     'Saucer Formation'     SS
; SS    Author: David Plotkin   SS
; SS     Copyright (c) 1982     SS
; SS SoftSide Publications, Inc SS
; SS                            SS
; SS SS SS SS SS SS SS SS SS SS SS

; Init Game

1 GOSUB 940:GOTO 100

; Game Logic

2 IF COL=N2 OR COL=N6 OR COL=N10 THEN N=N1:GOTO 5
3 IF COL=N4 OR COL=12 THEN N=N2:GOTO 5
4 IF COL=N8 THEN N=N3
5 MIS=N0:D=USR(1600,PB+768+MISY,PB+356)
6 POKE 53278,N1:NUMT(N)=NUMT(N)-N1
7 D=USR(1536,PB+1024+N*256+Y(N),PB+356-N4*NUMT(N)):FOR JW=15 TO N0 STEP M1:FOR JZ=N0 TO 9:SOUND N0,30+JZ,N10,JW
8 NEXT JZ:NEXT JW:FOR JW=N1 TO N5:NEXT JW:SOUND N0,N0,N0,N0:SC=SC+N10:POSITION N6,N0:? #N6;SC:SOUND N1,256-SC/N10,N10,N4
9 SOUND N2,246-SC/N10,N10,N4:IF NUMT(N1)=N0 AND NUMT(N2)=N0 AND NUMT(N3)=N0 THEN POP :GOTO 700
10 RETURN

; Game Loop

100 ST=STICK(N0):X0=X0+N4*((ST=7)-(ST=11)):IF X0<48 THEN X0=48
110 IF X0>200 THEN X0=200
120 POKE 53248,X0:IF STRIG(N0)=N1 THEN 140
130 D=USR(1600,PB+768+MISY,PB+356):MISX=X0+N3:MISY=Y0-N8:POKE 53252,MISX:MIS=N1:GOTO 160
140 IF MIS=N0 THEN 190
150 D=USR(1600,PB+768+MISY,PB+356):MISY=MISY-N8:IF MISY<40 THEN MIS=N0:GOTO 190
160 D=USR(1600,PB+768+MISY,PB+488):COL=PEEK(53256):IF COL=N0 THEN 190
170 GOSUB N2
190 P=P+N2*(X(N1)<48)-N2*(X(N3)>200):FOR N=N1 TO N3
200 X(N)=X(N)+N4*((P=N1)-(P=M1)):IF NUMT(N)=N0 THEN 280
210 IF FL(N)=N1 THEN 240
220 POKE 53248+N,X(N):XT(N)=X(N):R=INT(RND(N0)*N10):IF R=N0 THEN FL(N)=N1
230 GOTO 280

240 D=USR(1536,PB+1024+N*256+Y(N),PB+356):Y(N)=Y(N)+N8:IF Y(N)<208 THEN 260
250 Y(N)=48:XT(N)=X(N):FL(N)=N0:POKE 53248+N,X(N):D=USR(1536,PB+1024+N*256+Y(N),PB+356-N4*NUMT(N)):GOTO 280
260 IF Y(N)+N4*NUMT(N)<208 THEN XT(N)=XT(N)+N2*(X0>XT(N)+N3)-N2*(X0<XT(N)+N3):POKE 53248+N,XT(N)
270 D=USR(1536,PB+1024+N*256+Y(N),PB+356-NUMT(N)*N4)
280 NEXT N:IF MIS=N1 THEN D=USR(1600,PB+768+MISY,PB+488)
285 COL=PEEK(53256):IF COL THEN GOSUB N2
290 IF PEEK(53260)<>0 THEN NS=NS-N1:GOTO 400
300 FOR N=N1 TO N3:IF NUMT(N)=N0 OR MIS(N)=N1 OR (Y(N)+NUMT(N)*N4>200) THEN 330
310 R=INT(RND(N0)*N10):IF R<>0 THEN 360
320 MISX(N)=XT(N)+N3:MISY(N)=Y(N)+NUMT(N)*N4+N8:MIS(N)=N1:POKE 53252+N,XT(N)+N3:D=USR(1600,PB+768+MISY(N),PB+488+N*N8)
330 IF MIS(N)=N0 THEN 360
340 D=USR(1600,PB+768+MISY(N),PB+356):MISY(N)=MISY(N)+12:IF MISY(N)>208 THEN MIS(N)=N0:GOTO 360
350 D=USR(1600,PB+768+MISY(N),PB+488+N*N8):IF PEEK(53256+N)=N1 THEN NS=NS-N1:GOTO 400
360 NEXT N
370 POKE 53278,N1:GOTO N100
400 SOUND N0,N0,N0,N0:SOUND N1,N0,N0,N0:SOUND N2,N0,N0,N0:FOR N=10 TO 150:POKE 704,N:SOUND N0,N,N8,N8:NEXT N
410 D=USR(1570,PB+1024+Y0,PB+356):SOUND N0,N0,N0,N0:D=USR(1600,PB+768+MISY,PB+356):MIS=N0
420 FOR N=N1 TO N3:D=USR(1536,PB+1024+N*256+Y(N),PB+356):D=USR(1600,PB+768+MISY(N),PB+356):MIS(N)=N0:NEXT N
430 FOR N=N1 TO 100:NEXT N:POKE 53278,N1
440 IF NS=N0 THEN 500
450 X0=120:X(N1)=48:X(N2)=74:X(N3)=N100:Y0=200:POKE 704,20:D=USR(1570,PB+1024+Y0,PB+472):POKE 53248,X0
460 FOR N=N1 TO N3:Y(N)=48:POKE 53248+N,X(N):XT(N)=X(N):FL(N)=N0
470 D=USR(1536,PB+1024+N*256+Y(N),PB+356-NUMT(N)*N4)
480 NEXT N:POSITION 18,N0:? #N6;NS
490 GOTO N100

; Game Over

500 ? #N6;CHR$(125):POSITION N6,N4:? #N6;"":? #N6;" FINAL SCORE  ";SC
510 POSITION N6,N6:? #N6;"POINTS":? #N6;"   TO PLAY AGAIN":? #N6;"  PRESS fire BUTTON"
520 FOR W=150 TO 50 STEP M1:IF STRIG(N0)=N0 THEN 550
530 SOUND N0,W,N10,N6:SOUND N1,W+N10,N10,N6:SOUND N2,W+50,N10,N6:SOUND N3,W+N100,N10,N6:NEXT W
540 GOTO 520

; Restart

550 FOR N=N0 TO N3:SOUND N,N0,N0,N0:NEXT N:GOSUB 1140:GOTO N100

; Level Initialization

700 FOR N=N1 TO N3:D=USR(1536,PB+1024+N*256+Y(N),PB+356):D=USR(1600,PB+768+MISY(N),PB+356):MIS(N)=N0:NEXT N
710 X(N1)=48:X(N2)=74:X(N3)=N100:FOR N=N1 TO N3:NUMS(N)=NUMS(N)+N1:IF NUMS(N)>16 THEN NUMS(N)=16
720 NUMT(N)=NUMS(N):Y(N)=48:POKE 53248+N,X(N):XT(N)=X(N):FL(N)=N0:NEXT N
730 IF SC>1000 THEN POKE 53257,N0:POKE 53258,N0:POKE 53259,N0
740 FOR N=N1 TO N3:D=USR(1536,PB+1024+N*256+Y(N),PB+356-NUMT(N)*N4):NEXT N
750 GOTO N100

800 END

; Game Initialization

940 N0=0:N1=1:N2=2:N3=3:N4=4:N5=5:N6=6:N8=8:N10=10:N100=100:M1=-1
950 GRAPHICS N2+16:A=PEEK(106)-16:POKE 54279,A:PB=256*A:POKE 559,62:POKE 53277,N3:POKE 623,N1
960 POSITION 7,N4:? #N6;"SAUCER":POSITION N5,N5:? #N6;""
970 FOR W=50 TO 150:SOUND N0,W,N10,N6:SOUND N1,W+N10,N10,N6:SOUND N2,W+50,N10,N6:SOUND N3,W+N100,N10,N6:NEXT W
980 SOUND N0,N0,N0,N0:SOUND N1,N0,N0,N0:SOUND N2,N0,N0,N0:SOUND N3,N0,N0,N0
1000 FOR A=1536 TO 1560:READ I:POKE A,I:NEXT A:DIM NUMS(N3),NUMT(N3),FL(N3),MIS(N3),X(N3),Y(N3),XT(N3),YT(N3)
1005 DIM MISX(N3),MISY(N3)
1010 DATA 104,104,133,204,104,133,203,104,133,207,104,133,206,160,0,177,206,145,203,200,192,64,208,247,96
1020 FOR N=N0 TO 23:RESTORE 1030:FOR A=PB+260+N*N4 TO PB+263+N*N4:READ I:POKE A,I:NEXT A:NEXT N
1030 DATA 153,189,255,0
1040 FOR A=PB+356 TO PB+471:POKE A,N0:NEXT A
1050 FOR A=PB+472 TO PB+487:READ I:POKE A,I:NEXT A
1060 DATA 40,40,56,56,16,16,56,56,56,56,254,254,146,146,146,146
1070 FOR A=1570 TO 1594:READ I:POKE A,I:NEXT A
1080 DATA 104,104,133,204,104,133,203,104,133,207,104,133,206,160,0,177,206,145,203,200,192,16,208,247,96
1090 FOR A=1600 TO 1624:READ I:POKE A,I:NEXT A
1100 DATA 104,104,133,204,104,133,203,104,133,207,104,133,206,160,0,177,206,145,203,200,192,8,208,247,96
1110 FOR A=PB+488 TO PB+519:READ I:POKE A,I:NEXT A
1120 DATA 3,3,3,3,3,3,3,3,12,12,12,12,12,12,12,12,48,48,48,48,48,48,48,48,192,192,192,192,192,192,192,192
1130 FOR I=PB+768 TO PB+2048:POKE I,N0:NEXT I
1140 X0=120:X(N1)=48:X(N2)=74:X(N3)=N100:POKE 53248,X0:POKE 53249,X(N1)
1150 POKE 53250,X(N2):POKE 53251,X(N3):Y0=200:Y(N1)=48:Y(N2)=48:Y(N3)=48
1160 POKE 53257,N1:POKE 53258,N1:POKE 53259,N1:POKE 704,20:POKE 705,214:POKE 706,N100:POKE 707,166
1170 D=USR(1570,PB+1024+Y0,PB+472):D=USR(1536,PB+1280+Y(N1),PB+352)
1180 D=USR(1536,PB+1536+Y(N2),PB+352):D=USR(1536,PB+1792+Y(N3),PB+352)
1190 FOR N=N1 TO N3:NUMS(N)=N1:NUMT(N)=N1:FL(N)=N0:MIS(N)=N0:NEXT N:MIS=N0:P=N1:SC=N0:NS=N3:MISX=N0:MISY=N0
1200 ? #N6;CHR$(125):FOR N=N1 TO 20:POSITION INT(RND(N0)*19),INT(RND(N0)*11):? #N6;".":NEXT N
1210 POSITION N0,N0:? #N6;"score ";SC:POSITION 12,N0:? #N6;"bases ";NS:RETURN
