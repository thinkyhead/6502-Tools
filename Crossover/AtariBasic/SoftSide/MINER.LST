10 . ************************
11 . * MINER V1.0           *
12 . * (C)1980 PHILLIP CASE *
13 . ************************
14 .
15 DIM AS$(20)
20 PX=27:PY=2:GR.0:M=500:EP=3
22 POK.752,1
40 F.Y=4TO22:POS.2,Y:?">";:F.X=3TO38:?CHR$(160);:N.X:?"<";:SO.0,Y,8,2:N.Y
50 F.X=0TO36:?CHR$(16);:N.X
60 .
70 F.Y=4TO22:POS.34,Y:?"   ";:N.Y
80 POS.20,2:?"BANK: ";CHR$(1);" ";CHR$(4);:POS.26,1:?CHR$(17);CHR$(18);CHR$(5);
110 GOS.390
120 GOS.280
130 F.T=1TO20:AS$(T)=CHR$(160):N.T
132 POS.15,7:?" MINER ";:POS.16,9:?" BY ";:POS.11,11:?" PHILLIP  CASE ";
134 POS.11,17:?" FIRE TO START "
136 IFSTRIG(0)<>0THEN136
138 F.Y=7TO17:POS.10,Y:?AS$;:N.Y
140 GOS.410
150 .
160 POS.PX,PY:?"X";CHR$(30);:F.T=1TO15:N.T:?"+";CHR$(30);:F.T=1TO15:N.T
162 ? " ";:F.T=1TO15:N.T
170 DIR=STICK(0)
180 IFSTRIG(0)=0THEN780
182 IFDIR=15THEN160
184 XX=PX:YY=PY
190 IFPY=2 AND PX=27THENPY=3:GOS.720:G.150
200 IFDIR=14 AND PY<>5 AND PY<>1THENYY=PY-1
202 IFDIR=13 AND PY<>3THENYY=PY+1
204 IFDIR=11THENXX=PX-1
206 IFDIR=7THENXX=PX+1
210 IFXX=34 AND YY=EP THEN GOS.620
220 GOS.690
230 IFNM=1THENSO.0,0,0,0:G.160
235 SO.0,200,10,14
236 SO.0,0,0,0
240 IFA=46THENGOS.490:G.270
250 IFA<>32THENGOS.440
260 PX=XX:PY=YY
270 G.150
280 .
290 .
300 .
310 LOC.34,EP-1,A:IFMP=1 AND A<>32THENRET.
320 IFMP=2 AND EP=23THENRET.
330 LOC.34,EP+1,A:POS.34,EP+1:?CHR$(A);:IFMP=2 AND A<>32THENRET.
340 IFMP=1 AND EP=2THENRET.
350 IFMP=1THENEP=EP-1
355 IFMP=2THENEP=EP+1
360 POS.34,EP:?CHR$(138);CHR$(160);CHR$(136);:IFEP>21THEN370
362 IFMP=1THENPOS.34,EP+1:?"   ";
370 IFEP<>1THENLOC.34,EP-1,A:IFA<>160THENPOS.34,EP-1:?" ";CHR$(160);" ";:MP=0:RET.
372 RET.
374 ? CHR$(A);:RET.
390 .
400 GP=501+INT(RND(0)*300):GOS.740:RET.
410 .
420 F.T=1TO35
430 X=INT(RND(0)*35):Y=INT(RND(0)*17+6):LOC.X,Y,A:IFA<>160THEN430
432 SO.0,200,12,10:POS.X,Y:?".";:SO.0,0,0,0:N.T:RET.
440 .
450 IFM<7000THEN460
452 GR.0:F.A=1TO10:?AS$(1,A*2);"YOU WIN!!!!":N.A
454 ? :?"NOW YOU CAN SELL YOUR CLAIM TO A":?"BIG MINING COMPANY AND RETIRE"
456 ? "ON THE ROYALTIES"
458 G.810
460 M=M-5:GOS.740
470 IFM>0THENRET.
475 GR.0:?"YOU HAVE GONE BANKRUPT.":?"PRESS FIRE TO PLAY AGAIN."
480 IFSTRIG(0)THEN480
485 RUN
490 .
500 GOS.390
510 IFA=46THENCK=INT(RND(0)*5+1):POS.2,3:ON CK GOS.530,540,560,600,610:GOS.740
512 POS.2,3:?"                             ";:RET.
530 G=INT(RND(0)*3+1):GC=GC+G:?"GOLD NUGGET, ";G;" OZS.";:POS.XX,YY:?"G";
532 F.A=1TO10:F.X=1TO50:SO.0,X,10,10:N.X:F.X=50TO1STEP-1:SO.0,X,10,10:N.A
534 ? CHR$(30);" ";:RET.
540 ? "UNDERGROUND SPRING!!!";:POS.XX,YY:?"S";:SO.0,1,0,6
542 F.Y=22TOYY STEP-1:F.X=3TO38:LOC.X,Y,A:POS.X,Y:?CHR$(A);
544 IFY=YY AND X<XX THEN 548
546 LOC.X,Y,A:POS.X,Y:?CHR$(A);:IFA=32THENPOS.X,Y:?"%";
548 N.X:N.Y
550 POS.XX,YY:?"%";:SO.0,0,0,0:RET.
560 PX=XX:PY=YY:?"CAVE-IN!!!";:POS.XX,YY:?" ";
565 F.X=XX-4TOXX+4:F.Y=YY-1TOYY+1:SO.INT(RND(0)*4),INT(RND(0)*100)+150,12,12
570 IFX<2 OR X>39 OR Y<1 OR Y>23THEN574
572 LOC.X,Y,A:POS.X,Y:IFA=32THEN? CHR$(160);:G.574
573 ? CHR$(A);
574 N.Y:N.X
580 XX=PX:YY=PY:IFRND(0)<0.2THENPOS.2,3:?"YOU LOST ALL YOUR GOLD!!!";:GC=0:F.A=1TO500:N.A
582 F.X=0TO3:SO.X,0,0,0:N.X:RET.
590 POS.XX,YY:?CHR$(160);:RET.
600 ? "SANDSTONE, EASY DIGGING";:POS.XX,YY:?" ";:M=M+4:F.A=1TO300:N.A
605 RET.
610 SO.0,5,10,14:?"SOLID ROCK, PICKAXE WON'T DO";:POS.XX,YY:?"R";
615 SO.0,100,10,10:F.T=1TO10:N.T:SO.0,0,0,0:F.A=1TO300:N.A:RET.
620 XX=PX:YY=PY
630 SO.0,EP*10,10,6:MP=0:POS=STICK(0):IFPOS=7 OR POS=15THEN630
640 IFPOS=10 OR POS=14 OR POS=6THENMP=1
645 IFPOS=13 OR POS=9 OR POS=5THENMP=2
655 IFPOS=11 AND EP<>4THEN670
660 GOS.280:G.630
670 LOC.33,EP,A:IFA=32 OR A=160THENXX=33:YY=EP:SO.0,0,0,0:RET.
680 G.630
690 NM=0
695 IFXX<2 OR XX>33 OR YY<0THENNM=1
700 LOC.XX,YY,A:POS.XX,YY:?CHR$(A);:IFA<>46 AND A<>32 AND A<>160THENSO.0,50,10,10:NM=1:RET.
710 RET.
720 .
725 IFGC=0THENRET.
730 M=M+(GC*GP):GC=0:F.A=1TO14:SO.0,0,0,0:POS.10,2:?"$$$$$$$$";:F.B=1TO20:N.B
731 SO.0,200-A*10,6,10
732 SE.2,A+1,2:POS.10,2:?"        ":F.B=1TO20:N.B:N.A:SE.2,9,2:GOS.740:RET.
740 .
750 POS.2,0:?"GM $";GP;:POS.13,0:?GC;" OZS.";:POS.22,0:?"CASH $";M;"   ";
752 IFM>7000THENGOS.760:G.440
754 RET.
760 .
765 SO.0,0,0,0
770 F.A=1TO10:POS.22,0:?"CASH $";M;:F.B=1TO100:N.B:POS.22,0:?"             ";
772 F.B=1TO100:N.B:N.A:RET.
780 .
790 GR.0:?:?"           MINERS LUCK":?:?"TOO BAD THE OLD MINE DIDN'T PAN OUT."
795 SO.0,255,12,12
800 F.T=1TO1000:N.T
810 ? :?"PRESS FIRE TO CONTINUE"
820 IFSTRIG(0)<>0THEN820
830 RUN
